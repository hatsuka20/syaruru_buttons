<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>しゃるるぼたん</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="button.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body>
    <main>
        <h1>しゃるるぼたん</h1>

        <div class="buttons"></div>

        <script>
            $(document).ready(function () {
                var playing = false;

                $(".audio-button").each(function () {
                    var $button = $(this);
                    var $audio = $button.find("audio");

                    $($("<span>").text($audio.attr("name"))).insertBefore($audio);
                });

                $(".audio-button").click(function () {
                    var $button = $(this);
                    var audio = $button.find("audio")[0];

                    if (playing !== true) {
                        audio.play();
                    } else {
                        audio.pause();
                    }

                    $button.toggleClass("playing");
                    playing = !playing
                });
            });

            $(function () {
                $.getJSON("buttons.json", function (data) {
                    for (var i = 0; i < data.length; i++) {
                        $(".buttons").append("<button class=\"fa audio-button\"><audio src=\"" + data[i].path + "\" name=\"" + data[i].name + "\"></audio></button>");
                    }
                });
            });
        </script>

    </main>

</body>

</html>
